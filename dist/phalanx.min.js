/*! Phalanx - v0.0.5 ( 2013-12-11 ) - MIT */
!function(a){"use strict";function b(a,b){var f;return"function"==typeof a?f=a:(b=a,f=b.hasOwnProperty("constructor")?b.constructor:function(){}),delete b.constructor,_.extend(f.prototype,b),f.create=d,f.extend=Backbone.View.extend,f.mixin=c,f.prototype.callSuper=e,f}function c(a,b){var c,d=0,e=Object.keys(a),f=e.length,g={};for(b||(b={});f>d;d++)c=e[d],b[c]?g[b[c]]=a[c]:g[c]=a[c];return this.prototype=_.extend(g,this.prototype),this}function d(){var a=Object.create(this.prototype);return this.apply(a,arguments),a}function e(a,b){return this.constructor.__super__[a].apply(this,b)}var f={};f.AsyncCallbacks={onSuccess:function(){},onFailure:function(){}},f.EntityObserver={eventSplitter:/^(\S+)\s*(.*)$/,entityListeners:{},listenToEntity:function(){for(var a,b,c=0,d=Object.keys(this.entityListeners);a=d[c++];){if(b=this.entityListeners[a],a=a.match(this.eventSplitter),!this[a[2]])throw new Error("Entity `"+a[2]+"` is unknown property");if(!_.isFunction(this[b]))throw new Error("Method `"+b+"` is not exists this Entity");this.listenTo(this[a[2]],a[1],this[b])}},stopListeningEntity:function(){for(var a,b=0,c=_.map(this.entityListeners,_.bind(function(a,b){return b.match(this.eventSplitter)[2]},this));a=c[b++];)this.stopListening(this[a])}},f.LifecycleCallbacks={onCreate:function(){},initialize:function(){},onSetElement:function(){},onPause:function(){},onResume:function(){},onDestroy:function(){}},f.Observable=Backbone.Events;var g='[data-ui="{name}"]';f.UiLookupable={el:null,ui:{},$ui:{},lookupUi:function(){var a,b,c=this.el instanceof Backbone.$?this.el:Backbone.$(this.el),d=0,e=Object.keys(this.ui),f=e.length;for(this.ui={},this.$ui={};f>d;d++)a=e[d],b=g.replace("{name}",a),this.$ui[a]=c.find(b),this.ui[a]=this.$ui[a].length?this.$ui[a][0]:null},releaseUi:function(){for(var a,b=0,c=Object.keys(this.ui),d=c.length;d>b;b++)a=c[b],this.$ui[a]=null,this.ui[a]=null}};var h=b({constructor:function(a){a||(a={}),this.onCreate.apply(this,arguments),Backbone.Router.apply(this,arguments)}});h.mixin(f.LifecycleCallbacks),_.extend(h.prototype,Backbone.Router.prototype,{destroy:function(){this.onDestroy()}});var i=b({constructor:function(){this._processedListeners={},this._createdComponents={},this._processListeners(),this.onCreate.apply(this,arguments),Backbone.View.apply(this,arguments)}});i.mixin(f.UiLookupable).mixin(f.LifecycleCallbacks);var j="data-component",k="data-component-uid";_.extend(i.prototype,Backbone.View.prototype,{events:{},components:{},listeners:{},_createdComponents:{},_processedListeners:{},persistent:!1,paused:!1,setElement:function(){Backbone.View.prototype.setElement.apply(this,arguments),this.el&&this.el.parentNode&&(this.lookupUi(),this.onSetElement())},delegateEvents:function(a){var b;null==a?(b=this._getComponentEvents(),Backbone.View.prototype.delegateEvents.apply(this,[_.extend(b,this.events)])):Backbone.View.prototype.delegateEvents.apply(this,arguments)},_getComponentEvents:function(){for(var a,b,c,d,e={},f=0,g=Object.keys(this.components),h=g.length;h>f;f++){if(a=g[f],null==this.components[a])throw new Error(a+" Class is not exists.");b=this.components[a].prototype,c=_.keys(b.events),d=_.map(b.events,this._getComponentEventClosure),_.extend(e,_.object(c,d))}return e},_getComponentEventClosure:function(a){return function(b){var c=this.getComponent(b.target);return c[a].apply(c,arguments)}},getComponent:function(a){var b,c;do b=a.getAttribute(j);while(!b&&(a=a.parentNode));if(!b)throw new Error("Component name is not detected from `"+j+"`");return c=a.getAttribute(k),this._createdComponents[c]?this._createdComponents[c]:this._newComponent(b,a)},_newComponent:function(a,b){var c,d;return c=new this.components[a](b),d=c.uid,this._listenToComponent(c,a),b.setAttribute(k,d),this._createdComponents[d]=c,c},_listenToComponent:function(a,b){var c,d,e,f,g,h;if(c=this._processedListeners[b])for(d=0,e=Object.keys(c),f=e.length;f>d;d++){if(g=e[d],h=c[g],!_.isFunction(this[h]))throw new Error("Method `"+h+"` is not exists this View");this.listenTo(a,g,this[h])}},_processListeners:function(){for(var a,b,c,d=0,e=Object.keys(this.listeners),f=e.length;f>d;d++)a=e[d].split(/\s+/),b=this.listeners[e[d]],c=this._processedListeners[a[1]],c||(c=this._processedListeners[a[1]]={}),c[a[0]]=b},destroyComponents:function(){for(var a,b,c=0,d=Object.keys(this._createdComponents),e=d.length;e>c;c++)a=d[c],b=this._createdComponents[a],b.destroy(),this._createdComponents[a]=null,delete this._createdComponents[a]},destroy:function(){this.destroyComponents(),this.undelegateEvents(),this.stopListening(),this.releaseUi(),this.onDestroy(),this.el=this.$el=null,this.model=this.collection=null,this.options=this._processedListeners=null},pause:function(){this.paused=!0,this.onPause(),this.destroyComponents(),this.undelegateEvents(),this.stopListening(),this.releaseUi()},resume:function(){this.paused=!1,this.delegateEvents(),this.lookupUi(),this.onResume()},onSetElement:function(){},render:function(a){return this.$el.html(a),this}});var l=b({constructor:function(a,b){b||(b={}),this.onCreate.apply(this,arguments),Backbone.Model.apply(this,arguments)}});l.mixin(f.LifecycleCallbacks),_.extend(l.prototype,Backbone.Model.prototype,{syncParam:{},sync:function(a,b,c){return _.extend(c,this.syncParam),Backbone.Model.prototype.sync.apply(this,arguments)},destroy:function(){Backbone.Model.prototype.destroy.apply(this,arguments),this.onDestroy()}});var m=b({constructor:function(a,b){b||(b={}),this.onCreate.apply(this,arguments),Backbone.Collection.apply(this,arguments)}});m.mixin(f.LifecycleCallbacks),_.extend(m.prototype,Backbone.Collection.prototype,{syncParam:{},sync:function(a,b,c){return _.extend(c,this.syncParam),Backbone.Collection.prototype.sync.apply(this,arguments)},destroy:function(){this.reset(),this.onDestroy()}});var n=b({constructor:function(){this._assignedMap={},i.apply(this,arguments)}});_.extend(n.prototype,i.prototype,{events:{},regions:{},_assignedMap:{},assign:function(a,b){var c,d,e;if(c=this.regions[a],d=this.getRegionView(a),this.$el){if(e=this.$el.find(c)[0],!c||!e)throw new Error("Could not get element of `"+c+"` from the region "+a);this.onChange(a,b,d),d&&(d.persistent?(d.pause(),d.$pausingCache=d.$el.children()):d.destroy()),this._assignedMap[a]=b,b.persistent&&b.paused?(b.$el.empty().append(b.$pausingCache),b.$pausingCache=null,b.resume()):b.setElement(e)}},_copyAttrs:function(a,b){b.setAttribute("id",a.getAttribute("id")||""),b.setAttribute("class",a.getAttribute("class")||""),b.setAttribute("style",a.getAttribute("style")||"")},isRegionExists:function(a){if(!(a in this.regions))throw new Error("Specified region `"+a+"` is not declared");return!!this.$el.find(this.regions[a]).length},getRegionView:function(a){if(!(a in this.regions))throw new Error("Specified region `"+a+"` is not declared");return this._assignedMap[a]},withdraw:function(a){var b=this.getRegionView(a);this._assignedMap[a]=null,b&&b.destroy()},destroy:function(){for(var a,b=0,c=Object.keys(this.regions);a=c[b++];)this.withdraw(a);i.prototype.destroy.apply(this,arguments)},pause:function(){for(var a,b=0,c=Object.keys(this.regions);a=c[b++];)this.getRegionView(a)&&this.getRegionView(a).pause();i.prototype.pause.apply(this,arguments)},resume:function(){for(var a,b=0,c=Object.keys(this.regions);a=c[b++];)this.getRegionView(a)&&this.getRegionView(a).resume();i.prototype.resume.apply(this,arguments)},onChange:function(){}});var o=0,p=b({events:{},id:null,uid:null,params:{},constructor:function(a){this.uid=o++,this.params=_.clone(this.params),this.onCreate.apply(this,arguments),this.setElement(a),this.initialize.apply(this,arguments)},setElement:function(a){this.$el=a instanceof Backbone.$?a:Backbone.$(a),this.el=this.$el[0],this.el&&this.el.parentNode&&(this.lookupUi(),this.onSetElement(),this.id=parseInt(this.el.getAttribute("data-id"),10))},destroy:function(){this.releaseUi(),this.onDestroy(),this.el=this.$el=null},onSetElement:function(){}});p.mixin(f.Observable).mixin(f.UiLookupable).mixin(f.LifecycleCallbacks);var q={defineClass:b,Router:h,Model:l,Collection:m,View:i,Layout:n,Component:p,Trait:f};"function"==typeof define&&"object"==typeof define.amd&&define.amd?a.define(function(){return q}):"object"==typeof module&&module&&"object"==typeof exports&&exports&&module.exports===exports?module.exports=q:a.Phalanx=q}(this);
/*
//@ sourceMappingURL=phalanx.map
*/