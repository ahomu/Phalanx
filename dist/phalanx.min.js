/*! Phalanx - v0.0.0 ( 2013-05-09 ) - MIT */
(function(t){"use strict";function e(t,e){var s;1===arguments.length?e=t:s=t;var r="function"==typeof s?s:e.hasOwnProperty("constructor")?e.constructor:function(){};return delete e.constructor,_.extend(r.prototype,e),r.extend=Backbone.View.extend,Object.defineProperty(r,"extend",i),r.with=n,Object.defineProperty(r,"with",i),r.create=o,Object.defineProperty(r,"create",i),r}function n(t,e){var n,o=0,i=Object.keys(t),s=i.length,r={};for(e||(e={});s>o;o++)n=i[o],e[n]?r[e[n]]=t[n]:r[n]=t[n];return _.extend(this.prototype,r),this}function o(){var t=Object.create(this.prototype);return this.apply(t,arguments),t}var i={writable:!1},s="__UNDEFINED__",r=e({constructor:function(t){t||(t={}),this.onCreate.apply(this,arguments),Backbone.View.apply(this,arguments)}}),a=Backbone.View.prototype,u="data-component",c="data-component-uid",l=0;_.extend(r.prototype,a,{name:s,events:{},ui:{},components:{},_createdComponents:{},setElement:function(t){this.onSetElement(t),a.setElement.apply(this,arguments),this.lookupUi()},delegateEvents:function(t){if(a.delegateEvents.apply(this,arguments),null==t){var e,n,o,i,s={};for(e in this.components)n=this.components[e].prototype,o=_.keys(n.events),i=_.map(n.events,this._getComponentEventClosure),_.extend(s,_.object(o,i));a.delegateEvents.apply(this,[s])}},_getComponentEventClosure:function(t){return function(e){var n=this.getComponent(e.target);n[t].apply(n,arguments)}},getComponent:function(t){var e,n;do e=t.getAttribute(u);while(!e&&(t=t.parentNode));if(!e)throw Error("Component name is not detected from "+u);return n=t.getAttribute(c)||l++,this._createdComponents[n]?this._createdComponents[n]:(t.setAttribute(c,n),this._createdComponents[n]=new this.components[e](t,n))},lookupUi:function(){var t,e;for(t in this.ui)e=this.ui[t],this.ui[t]=this.$el.find(e)},releaseUi:function(){var t;for(t in this.ui)this.ui[t]=null,delete this.ui[t]},destroyComponents:function(){var t,e;for(t in this._createdComponents)e=this._createdComponents[t],e.destroy(),this._createdComponents[t]=null,delete this._createdComponents[t]},destroy:function(){this.undelegateEvents(),this.destroyComponents(),this.releaseUi(),this.onDestroy()},initialize:function(){},render:function(t){return this.$el.html(t),this},onCreate:function(){},onSetElement:function(){},onDestroy:function(){}});var h=e({constructor:function(t,e){e||(e={}),this.onCreate.apply(this,arguments),Backbone.Model.apply(this,arguments)}});_.extend(h.prototype,Backbone.Model.prototype,{initialize:function(){},onCreate:function(){},onDestroy:function(){}});var p=e({constructor:function(t,e){e||(e={}),this.onCreate.apply(this,arguments),Backbone.Collection.apply(this,arguments)}});_.extend(p.prototype,Backbone.Collection.prototype,{initialize:function(){},onCreate:function(){},onDestroy:function(){}});var f=e({regions:{},_assignedMap:{},constructor:function(t){t||(t={}),t.regions&&_.extend(this.regions,t.regions),this.onCreate.apply(this,arguments),this.initialize.apply(this,arguments)},assign:function(t,e){var n,o;if(n=this.regions[t],o=this.getRegionView(t),!n)throw Error("Could not get a selector from the region "+t);this.onChange(t,e,o),o&&o.destroy(),e.setElement($(n)[0]),this._assignedMap[t]=e},getRegionView:function(t){if(!t in this.regions)throw Error("Undefined region `"+t+"` is specified");return this._assignedMap[t]||null},withdraw:function(t){var e;return e=this.getRegionView(t),e.destroy(),this._assignedMap[t]=null,e},destroy:function(){this.onDestroy();for(var t,e=0,n=Object.keys(this.regions),o=this.regions.length;o>e;e++)t=n[e],this.withdraw(t)},onChange:function(){},initialize:function(){},onCreate:function(){},onDestroy:function(){}}),d=e({el:null,$el:null,events:{},ui:{},uid:null,constructor:function(t,e){this.$el=t instanceof Backbone.$?t:Backbone.$(t),this.el=this.$el[0],this.uid=e,this.lookupUi(),this.onCreate.apply(this,arguments),this.initialize.apply(this,arguments)},destroy:function(){this.el=this.$el=null,this.releaseUi(),this.onDestroy()},lookupUi:function(){var e,n,o={};for(e in this.ui)n=this.ui[e],o[e]="$"in t?this.$el.find(n):this.el.querySelectorAll(n);this.ui=o},releaseUi:function(){var t;for(t in this.ui)this.ui[t]=null,delete this.ui[t]},initialize:function(){},onCreate:function(){},onDestroy:function(){}}),y={defineClass:e,Model:h,View:r,Collection:p,Layout:f,Component:d};"function"==typeof define&&"object"==typeof define.amd&&define.amd?t.define(function(){return y}):"object"==typeof module&&module&&"object"==typeof exports&&exports&&module.exports==exports?module.exports=y:t.Phalanx=y})(this);