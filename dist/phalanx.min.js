/*! Phalanx - v0.0.2 ( 2013-05-19 ) - MIT */
(function(t){"use strict";function e(t,e){var s;return"function"==typeof t?s=t:(e=t,s=e.hasOwnProperty("constructor")?e.constructor:function(){}),delete e.constructor,_.extend(s.prototype,e),s.extend=Backbone.View.extend,Object.defineProperty(s,"extend",r),s.with=n,Object.defineProperty(s,"with",r),s.create=o,Object.defineProperty(s,"create",r),s.prototype.super=i,s}function n(t,e){var n,o=0,i=Object.keys(t),s=i.length,r={};for(e||(e={});s>o;o++)n=i[o],e[n]?r[e[n]]=t[n]:r[n]=t[n];return _.extend(this.prototype,r),this}function o(){var t=Object.create(this.prototype);return this.apply(t,arguments),t}function i(t,e){return this.constructor.__super__[t].apply(this,e)}var s={},r={writable:!1};s.AsyncCallbacks={onSuccess:function(){},onFailure:function(){}},s.ElSettable={el:null,$el:null,setElement:function(t){this.$el=t instanceof Backbone.$?t:Backbone.$(t),this.el=this.$el[0],this.el&&this.el.parentNode&&this.onSetElement(this.el)},onSetElement:function(){}},s.LifecycleCallbacks={onCreate:function(){},initialize:function(){},onDestroy:function(){}},s.Observable=Backbone.Events;var a='[data-ui="{name}"]';s.UiLookupable={ui:{},$ui:{},_uiLookpped:!1,lookupUi:function(t){var e,n,o=t instanceof Backbone.$?t:Backbone.$(t),i=0,s=Object.keys(this.ui),r=s.length;for(this.ui={},this.$ui={};r>i;i++)e=s[i],n=a.replace("{name}",e),this.$ui[e]=o.find(n),this.ui[e]=this.$ui[e][0];this._uiLookupped=!0},releaseUi:function(){if(this._uiLookupped)for(var t,e=0,n=Object.keys(this.ui),o=n.length;o>e;e++)t=n[e],this.$ui[t]=null,delete this.$ui[t],this.ui[t]=null,delete this.ui[t]}};var l=e({constructor:function(t){t||(t={}),this.onCreate.apply(this,arguments),Backbone.Router.apply(this,arguments)}});l.with(s.LifecycleCallbacks),_.extend(l.prototype,Backbone.Router.prototype,{destroy:function(){this.onDestroy()}});var h=e({constructor:function(t){t||(t={}),this._createdComponents={},this.onCreate.apply(this,arguments),Backbone.View.apply(this,arguments)}});h.with(s.ElSettable).with(s.UiLookupable).with(s.LifecycleCallbacks);var c=Backbone.View.prototype,u="data-component",p="data-component-uid";_.extend(h.prototype,c,{events:{},components:{},_createdComponents:{},setElement:function(){c.setElement.apply(this,arguments),this.el&&this.el.parentNode&&(this.lookupUi(this.el),this.onSetElement(this.el))},delegateEvents:function(t){var e,n,o,i,s={},r=0,a=Object.keys(this.components),l=a.length;if(null==t){for(;l>r;r++)e=a[r],n=this.components[e].prototype,o=_.keys(n.events),i=_.map(n.events,this._getComponentEventClosure),_.extend(s,_.object(o,i));c.delegateEvents.apply(this,[_.extend(s,this.events)])}else c.delegateEvents.apply(this,arguments)},_getComponentEventClosure:function(t){return function(e){var n=this.getComponent(e.target);n[t].apply(n,arguments)}},getComponent:function(t){var e,n,o;do e=t.getAttribute(u);while(!e&&(t=t.parentNode));if(!e)throw Error("Component name is not detected from "+u);return o=t.getAttribute(p),o&&this._createdComponents[o]?this._createdComponents[o]:(n=new this.components[e](t),o=n.uid,t.setAttribute(p,o),this._createdComponents[o]=n,n)},destroyComponents:function(){for(var t,e,n=0,o=Object.keys(this._createdComponents),i=o.length;i>n;n++)t=o[n],e=this._createdComponents[t],e.destroy(),this._createdComponents[t]=null,delete this._createdComponents[t]},destroy:function(){this.undelegateEvents(),this.destroyComponents(),this.releaseUi(),this.onDestroy(),this.el=this.$el=null},render:function(t){return this.$el.html(t),this}});var d=e({constructor:function(t,e){e||(e={}),this.onCreate.apply(this,arguments),Backbone.Model.apply(this,arguments)}});d.with(s.LifecycleCallbacks),_.extend(d.prototype,Backbone.Model.prototype,{destroy:function(){Backbone.Model.prototype.destroy.apply(this,arguments),this.onDestroy()}});var f=e({constructor:function(t,e){e||(e={}),this.onCreate.apply(this,arguments),Backbone.Collection.apply(this,arguments)}});f.with(s.LifecycleCallbacks),_.extend(f.prototype,Backbone.Collection.prototype,{destroy:function(){this.reset(),this.onDestroy()}});var y=e({regions:{},options:{},_assignedMap:{},constructor:function(t){t||(t={}),t.el&&(this.el=t.el),t.regions&&_.extend(this.regions,t.regions),this._assignedMap={},this.onCreate.apply(this,arguments),this.el?this.setElement(this.el):this.setElement("<div />"),this.initialize.apply(this,arguments)},assign:function(t,e){var n,o,i;if(n=this.regions[t],o=this.getRegionView(t),i=this.$el.find(n)[0],!n||!i)throw Error("Could not get element of `"+n+"` from the region "+t);this.onChange(t,e,o),o&&o.destroy(),e.lookupUi&&e.lookupUi(i),e.setElement(i),this._assignedMap[t]=e},getRegionView:function(t){if(!(t in this.regions))throw Error("Specified region `"+t+"` is not declared");return this._assignedMap[t]},withdraw:function(t){var e;return e=this.getRegionView(t),e.destroy(),this._assignedMap[t]=null,e},destroy:function(){for(var t,e=0,n=Object.keys(this.regions),o=this.regions.length;o>e;e++)t=n[e],this.withdraw(t);this.onDestroy(),this.el=this.$el=null},onChange:function(){}});y.with(s.Observable).with(s.ElSettable).with(s.LifecycleCallbacks);var m=0,g=e({events:{},uid:null,constructor:function(t){this.uid=m++,this.onCreate.apply(this,arguments),this.lookupUi(t),this.setElement(t),this.initialize.apply(this,arguments)},destroy:function(){this.releaseUi(),this.onDestroy(),this.el=this.$el=null}});g.with(s.Observable).with(s.ElSettable).with(s.UiLookupable).with(s.LifecycleCallbacks);var b={defineClass:e,Router:l,Model:d,Collection:f,View:h,Layout:y,Component:g,Trait:s};"function"==typeof define&&"object"==typeof define.amd&&define.amd?t.define(function(){return b}):"object"==typeof module&&module&&"object"==typeof exports&&exports&&module.exports===exports?module.exports=b:t.Phalanx=b})(this);
//@ sourceMappingURL=phalanx.map